local player = game.Players.LocalPlayer
local mouse = player:GetMouse()
local RunService = game:GetService("RunService")
local highlight = Instance.new("Highlight")
highlight.FillColor = Color3.fromRGB(0, 100, 255)
highlight.OutlineColor = Color3.fromRGB(100, 180, 255)
highlight.FillTransparency = 0.5
highlight.OutlineTransparency = 0
highlight.Enabled = false
highlight.Parent = workspace

local currentTarget = nil
local disabled = false
local renderConn
local clickConn

local function copyToClipboard(text)
	if setclipboard then
		setclipboard(text)
	elseif syn and syn.write_clipboard then
		syn.write_clipboard(text)
	elseif Clipboard and Clipboard.set then
		Clipboard.set(text)
	else
		warn("Clipboard function not supported in this environment.")
	end
end

local function getPlayerFromMouse()
	local target = mouse.Target
	if not target then return nil end
	local model = target:FindFirstAncestorOfClass("Model")
	if not model then return nil end
	local targetPlayer = game.Players:GetPlayerFromCharacter(model)
	if targetPlayer and targetPlayer ~= player then
		return model
	end
	return nil
end

local function disableScript()
	if disabled then return end
	disabled = true
	highlight.Enabled = false
	if highlight.Parent then highlight:Destroy() end
	if renderConn then renderConn:Disconnect() end
	if clickConn then clickConn:Disconnect() end
	print("üîµ script done working.")
end

renderConn = RunService.RenderStepped:Connect(function()
	if disabled then return end
	local targetCharacter = getPlayerFromMouse()
	if targetCharacter then
		if currentTarget ~= targetCharacter then
			currentTarget = targetCharacter
			highlight.Adornee = targetCharacter
			highlight.Enabled = true
		end
	else
		currentTarget = nil
		highlight.Enabled = false
	end
end)

clickConn = mouse.Button1Down:Connect(function()
	if disabled then return end
	if not currentTarget then return end

	local head = currentTarget:FindFirstChild("Head")
	if not head then return end

	local leader = head:FindFirstChild("LEADER")
	if not leader then
		warn("‚ö†Ô∏è leader not found in head")
		return
	end

	local imageLabel = leader:FindFirstChild("ImageLabel")
	if not imageLabel then
		warn("‚ö†Ô∏è ImageLabel not found in leader")
		return
	end

	local imageId = imageLabel.Image
	if imageId and imageId ~= "" then
		copyToClipboard(imageId)
		print("‚úÖ copied:", imageId)
		disableScript()
	else
		warn("‚ö†Ô∏è ImageLabel does not has image")
	end
end)
